import numpy as np
import pandas as pd
import sklearn.metrics.pairwise as sklearn
from scipy.linalg import sqrtm
from scipy.sparse.linalg import svds
import matplotlib.pyplot as plt

ratings_df = pd.read_csv("ratings.csv", sep=',')
count_per_user = (ratings_df.groupby(by=['userId'])['rating']
                  .count()
                  .reset_index()
                  .rename(columns={"rating": "rating_count"}))

movies_df = pd.read_csv("movies.csv")

count_per_movie = (ratings_df.groupby(by=['movieId'])['rating']
                   .count()
                   .reset_index()
                   .rename(columns={"rating": "rating_count"}))
count_per_movie.head()
count_per_movie.describe()

# Graph
bins_values = [0, 1, 5, 15, 50, 100, 150, 300, count_per_movie["rating_count"].max()]
